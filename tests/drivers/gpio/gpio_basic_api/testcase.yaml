common:
  tags:
    - drivers
    - gpio
  depends_on: gpio
  harness: ztest
  harness_config:
    fixture: gpio_loopback

tests:
  drivers.gpio.2pin:
    min_flash: 34
    filter: dt_compat_enabled("test-gpio-basic-api")

  drivers.gpio.nrf_sense_edge:
    platform_allow: nrf52840dk/nrf52840 nrf52_bsim
    extra_args: "DTC_OVERLAY_FILE=boards/nrf52840dk_nrf52840.overlay;\
                 boards/nrf52840dk_nrf52840_sense_edge.overlay"

  drivers.gpio.mr_canhubk3_wkpu:
    platform_allow: mr_canhubk3
    extra_args: "DTC_OVERLAY_FILE=boards/mr_canhubk3_wkpu.overlay"

  drivers.gpio.2pin.nrf54h20dk_nrf54h20_cpuppr:
    tags:
      - drivers
      - gpio
    depends_on: gpio
    # Fix exclude when we can exclude just sim run
    platform_allow:
      - nrf54h20dk/nrf54h20/cpuppr
    sysbuild: true
    extra_configs:
      - vpr_launcher_CONFIG_NRF_REGTOOL_EXTRA_GENERATE_ARGS="-i ../../../tests/drivers/gpio/gpio_basic_api/boards/nrf54h20dk_nrf54h20_vpr_launcher.toml"
      # Disable asserts to fit in limited code memory
      - CONFIG_ASSERT=n
      - vpr_launcher_CONFIG_NRF_REGTOOL_VERBOSITY=2
    extra_args:
      - vpr_launcher_DTC_OVERLAY_FILE="../../../tests/drivers/gpio/gpio_basic_api/boards/nrf54h20dk_nrf54h20_vpr_launcher.overlay"
      - SB_CONFIG_VPR_LAUNCHER=y
